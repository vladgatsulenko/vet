{% extends 'base.html.twig' %}

{% block title %}{{ 'catalogTitle'|trans }}{% endblock %}

{% block body %}
<div class="row">
  <aside class="col-lg-3 mb-4">
    <form method="get" action="{{ path('app_catalog_index') }}">
      <div class="mb-3">
        <label class="form-label">{{ 'catalogSearchLabel'|trans }}</label>
        <input
          type="search"
          name="search"
          class="form-control"
          placeholder="{{ 'catalogSearchPlaceholder'|trans }}"
          value="{{ search is defined and search ? search : ''|e }}"
        >
      </div>

      <div class="mb-3">
        <label class="form-label">{{ 'catalogGroupLabel'|trans }}</label>
        <select name="group" class="form-select">
          <option value="">{{ 'catalogGroupAny'|trans }}</option>
          {% for g in groups %}
            <option value="{{ g.id }}" {{ selectedGroup is not null and selectedGroup == g.id ? 'selected' : '' }}>
              {{ g.name|e }}
            </option>
          {% endfor %}
        </select>
      </div>

      <div class="mb-3">
        <label class="form-label">{{ 'catalogSpeciesLabel'|trans }}</label>
        <select name="species" class="form-select">
          <option value="">{{ 'catalogGroupAny'|trans }}</option>
          {% for s in species %}
            <option value="{{ s.id }}" {{ selectedSpecies is not null and selectedSpecies == s.id ? 'selected' : '' }}>
              {{ s.name|e }}
            </option>
          {% endfor %}
        </select>
      </div>

      <div class="d-flex gap-2">
        <button type="submit" class="btn btn-primary">{{ 'catalogFilterApply'|trans }}</button>
        <a href="{{ path('app_catalog_index') }}" class="btn btn-outline-secondary">{{ 'catalogFilterReset'|trans }}</a>
      </div>
    </form>
  </aside>

  <main class="col-lg-9">
    {% if products is empty %}
      <div class="alert alert-warning">{{ 'catalogNoResults'|trans }}</div>
    {% else %}
      <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-3">
        {% for product in products %}
          <div class="col">
            {{ include('catalog/_card.html.twig', {'product': product}) }}
          </div>
        {% endfor %}
      </div>

      {{ include('partials/_pagination.html.twig', {
          pagination: pagination,
          route: 'app_catalog_index',
          routeParams: {
              search: search,
              group: selectedGroup,
              species: selectedSpecies
          }
      }) }}
    {% endif %}
  </main>
</div>
{% endblock %}
