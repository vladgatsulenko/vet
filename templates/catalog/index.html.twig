{% extends 'base.html.twig' %}

{% block title %}{{ 'catalogTitle'|trans }}{% endblock %}

{% block body %}
<div class="row">
  <aside class="col-lg-3 mb-4">
    <form method="get" action="{{ path('app_catalog_index') }}" autocomplete="off" novalidate>
      <div class="mb-3">
        <label class="form-label">{{ 'catalogSearchLabel'|trans }}</label>
        <input
          class="form-control form-control-sm me-2"
          type="search"
          name="search"
          placeholder="{{ 'navBarPlaceholder'|trans }}"
          aria-label="{{ 'navBarAria'|trans }}"
          value="{{ app.request.get('search') ?: app.request.get('query') }}"
          data-autocomplete="product"
          data-suggest-url="{{ path('app_search_suggest') }}"
        >

      </div>

      <div class="mb-3">
        <label class="form-label">{{ 'catalogGroupLabel'|trans }}</label>
        <select name="group" class="form-select">
          <option value="">{{ 'catalogGroupAny'|trans }}</option>
          {% for g in model.groups %}
            <option value="{{ g.id }}" {{ model.selectedGroup is not null and model.selectedGroup == g.id ? 'selected' : '' }}>
              {{ g.name|e }}
            </option>
          {% endfor %}
        </select>
      </div>

      <div class="mb-3">
        <label class="form-label">{{ 'catalogSpeciesLabel'|trans }}</label>
        <select name="species" class="form-select">
          <option value="">{{ 'catalogGroupAny'|trans }}</option>
          {% for s in model.species %}
            <option value="{{ s.id }}" {{ model.selectedSpecies is not null and model.selectedSpecies == s.id ? 'selected' : '' }}>
              {{ s.name|e }}
            </option>
          {% endfor %}
        </select>
      </div>

      <div class="d-flex gap-2">
        <button type="submit" class="btn btn-primary">{{ 'catalogFilterApply'|trans }}</button>
        <a href="{{ path('app_catalog_index') }}" class="btn btn-outline-secondary">{{ 'catalogFilterReset'|trans }}</a>
      </div>
    </form>
  </aside>

  <main class="col-lg-9">
    {% if model.products is empty %}
      <div class="alert alert-warning">{{ 'catalogNoResults'|trans }}</div>
    {% else %}
      <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-3">
        {% for product in model.products %}
          <div class="col">
            {{ include('catalog/_card.html.twig', {'product': product}) }}
          </div>
        {% endfor %}
      </div>

      {% set routeParams = {
        search: model.search,
        group: model.selectedGroup,
        species: model.selectedSpecies
      } %}

      {% include 'partials/_pagination.html.twig' with {
        pagination: model.pagination,
        route: 'app_catalog_index',
        routeParams: routeParams
      } %}
    {% endif %}
  </main>
</div>
{% endblock %}
